machine:
  environment:
    MY_BUILD_NUM: $CIRCLE_BUILD_NUM

test:
  pre:
    - echo $MY_BUILD_NUM
    - ls -la
    - ls -la ..
  post:
    - coverage run -p --source . :
        parallel: true
        files:
          - test_*.py
    - scp .coverage* node0:./$CIRCLE_PROJECT_REPONAME/: {parallel: true}
    - coverage combine
    - coverage report
    - coverage html -d $CIRCLE_ARTIFACTS/htmlcov
    - coveralls


